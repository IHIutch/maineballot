---
//  Moved this to its own file because script tags break Astro intellisense: https://github.com/withastro/language-tools/issues/800
import { env } from '#utils/env-vars'
---

<script
  is:inline
  async
  src={`https://www.googletagmanager.com/gtag/js?id=${env.GOOGLE_MEASUREMENT_ID}`}
></script>

<script
  is:inline
  define:vars={{
    isProd: import.meta.env.PROD,
    GOOGLE_MEASUREMENT_ID: env.GOOGLE_MEASUREMENT_ID,
  }}
>
  if (isProd) {
    ;(() => {
      window.dataLayer = window.dataLayer || []
      function gtag(...args) {
        dataLayer.push(args)
      }
      gtag('js', new Date())
      gtag('config', GOOGLE_MEASUREMENT_ID)
    })()
  }
</script>
